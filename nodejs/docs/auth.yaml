paths:
  /api/v1/auth/register:
    post:
      summary: 用户注册
      description: |
        新用户创建账号（无需授权）
        - 支持两种注册方式：用户名注册 或 手机号注册（二选一，不可同时为空）
        - 手机号需符合中国大陆11位格式（示例：13800138000）
        - 用户名长度3-20位，支持字母、数字、下划线
        - 密码需包含大小写字母+数字，长度8-20位
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - password  
              properties:
                username:
                  type: string
                  minLength: 3
                  maxLength: 20
                  pattern: '^[a-zA-Z0-9_]+$'
                  description: 用户名（二选一，唯一），支持字母、数字、下划线
                  example: test_user123
                phone:
                  type: string
                  pattern: '^1[3-9]\d{9}$'
                  description: 手机号（二选一，唯一），中国大陆11位格式
                  example: 13800138000
                email:
                  type: string
                  format: email
                  description: 邮箱（可选，若填写需唯一）
                  example: test123@example.com
                password:
                  type: string
                  minLength: 8
                  maxLength: 20
                  description: 密码（包含大小写字母+数字）
                  example: Abc123456
                nickname:
                  type: string
                  maxLength: 30
                  description: 昵称（可选）
                  example: 测试用户_123
              oneOf:
                - required: [username]
                - required: [phone]
            examples:
              用户名注册:
                summary: 用用户名+密码注册
                value:
                  username: test_user123
                  password: Abc123456
                  nickname: 测试用户_123
                  email: test123@example.com
              手机号注册:
                summary: 用手机号+密码注册
                value:
                  phone: 13800138000
                  password: Abc123456
                  nickname: 手机用户_8000
      responses:
        '201':
          $ref: '#/components/responses/SuccessCreate'
        '400':
          $ref: '#/components/responses/ParamError'
          examples:
            缺少必选参数:
              value:
                code: 400
                message: 参数错误
                details: ["用户名和手机号不能同时为空", "密码不能为空"]
            格式错误:
              value:
                code: 400
                message: 参数错误
                details: ["手机号格式不正确", "用户名仅支持字母、数字、下划线"]
        '409':
          $ref: '#/components/responses/Conflict'
          examples:
            用户名已存在:
              value:
                code: 409
                message: 资源冲突
                details: ["该用户名已被注册"]
            手机号已存在:
              value:
                code: 409
                message: 资源冲突
                details: ["该手机号已被注册"]
            邮箱已存在:
              value:
                code: 409
                message: 资源冲突
                details: ["该邮箱已被注册"]
        '500':
          $ref: '#/components/responses/ServerError'

  /api/v1/auth/login:
    post:
      summary: 用户登录
      description: |
        账号密码登录，获取 JWT Token
        - 登录账号支持：用户名 / 手机号（两者均可）
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - account
                - password
              properties:
                account:
                  type: string
                  description: 登录账号（用户名或手机号）
                  examples:
                    用户名登录: test_user123
                    手机号登录: 13800138000
                password:
                  type: string
                  description: 登录密码
                  example: Abc123456
            examples:
              用户名登录:
                summary: 用用户名登录
                value:
                  account: test_user123
                  password: Abc123456
              手机号登录:
                summary: 用手机号登录
                value:
                  account: 13800138000
                  password: Abc123456
      responses:
        '200':
          description: 登录成功（返回 Token 和用户信息）
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LoginResponse'
        '400':
          $ref: '#/components/responses/ParamError'
          examples:
            参数缺失:
              value:
                code: 400
                message: 参数错误
                details: ["账号不能为空", "密码不能为空"]
        '401':
          $ref: '#/components/responses/Unauthorized'
          examples:
            账号密码错误:
              value:
                code: 401
                message: 未授权
                details: ["账号或密码不正确"]
            Token无效:
              value:
                code: 401
                message: Token 已过期或无效
            未传Token:
              value:
                code: 401
                message: 请先登录获取授权
        '500':
          $ref: '#/components/responses/ServerError'

  /api/v1/auth/refresh-token:
    post:
      summary: 刷新 Token
      description: 用过期 Token 换取新 Token（避免重复登录）
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/TokenRefresh'
      responses:
        '200':
          description: 刷新成功（返回新 Token）
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TokenResponse'
        '400':
          $ref: '#/components/responses/ParamError'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/ServerError'